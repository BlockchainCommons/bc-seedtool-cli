# Seedtool Manual

*Copyright Â© 2020 by Blockchain Commons, LLC*

*Licensed under the "BSD-2-Clause Plus Patent License"*

---

The following is a draft design document. Comments requested.

There is no mention below of password functionality for BIP39 and SLIP39 production. The current design allows for later inclusion of this feature via a `--password` option.

## General Functionality

Supports help.

```
$ seedtool --help
<help text here>
```

Supports version number.

```
$ seedtool --version
1.0
```

## Generating Random Seeds

When run by itself, seedtool generates 32 random bytes (256 bits) and displays them as hex. This is the same as running `seedtool --out hex`.

```
$ seedtool
866b4a995209b20a87a4b32d7436363923cf99accd8f2a0b8b1dacf3f41113d9
```

An output format `--out` and count `--count` may be specified. The default count is 32.

Playing cards may be duplicated; it is as if each card is drawn from a freshly shuffled deck.

```
$ seedtool --out hex
3d1d142cd016cf8a393a1b477891c5e594fb7c9479b175a0db653067d6de0b17

$ seedtool --out bits
00100010011111110100010100010000

$ seedtool --out cards
5s4hth3s6s4s4hjdtdtdjckc7d5std6d5d4hqhkh4cks4h4sas5c6c2d6h2s2h2c

$ seedtool --out dice
23431546432642433535135232426424

$ seedtool --out base6
14135001101503150040353141454122

$ seedtool --out base10
73127665663823895387159704567613

$ seedtool --out cards --count 10
8hqd9h4sksjc3c7h7c6s
```

Sequences of random integers may be generated. By default, `--count` is 32, `--low` is 0, and `--high` is 9.

`low` < `high` < `256`

```
$ seedtool --out ints
8 6 4 1 2 0 5 1 4 7 0 7 8 0 3 3 0 6 8 3 4 1 0 4 5 4 0 4 7 6 4 4

$ seedtool --out ints --count 10 --low 1 --high 100
71 22 95 6 23 65 27 10 67 16
```

BIP39 can be used as an output format. The default `--count` is 32 bytes (256 bits, 24 words), but may be any multiple of 4 in [4,32].

```
$ seedtool --out bip39
stay puzzle motion ocean hotel drive market fiber voyage group swift fossil rebuild car favorite priority head slim capital digital loud body fetch document

$ seedtool --out bip39 --count 16
version tray choice heart door fabric sea buffalo chapter soda symbol garlic
```

SLIP39 can be used as an output format. By default `--count` is 32 bytes (256 bits, 33 words), but may be any multiple of 2 in [16,32]. By default a single 1-of-1 share is generated. This is the same as running `seedtool --out slip39 --group-threshold 1 --group 1-of-1`.

```
$ seedtool --out slip39
usher deal academic academic airline scene pickup makeup obesity eclipse ticket cinema therapy escape jury scroll credit easel failure costume manager theater branch swimming loan main losing move wolf snapshot frost decision acid

$ seedtool --out slip39 --count 16
formal husband academic academic devote client fangs carve acid maximum shelter trouble cubic firefly adapt grin shrimp therapy wits mayor
```

n-of-m SLIP39 shares can be generated by specifing one or more groups.

```
$ seedtool --out slip39 --count 16 --group 2-of-3
bucket stay academic acid cover shaft lilac blue oral buyer prisoner ultimate material raisin deadline forecast very damage writing blimp
bucket stay academic agency client traffic brother literary custody index piece sweater dragon fiber forbid pickup upstairs teaspoon fake cover
bucket stay academic always deliver lying space decent reject salary sniff manual pile herd predator activity desktop declare vexed sweater
```

Multiple groups and a group threshold may be specified. If omitted, the default `--group-threshold` is 1.

The first two words of a set of SLIP39 shares are the same across all the shares. Each group within a set of SLIP39 shares has the same third word.

```
$ seedtool --out slip39 --count 16 --group-threshold 2 --group 2-of-3 --group 3-of-5 --group 3-of-5
timely deal acrobat leaf artwork blessing subject mixture kitchen soldier depict practice hunting railroad enforce belong edge mansion lyrics surprise
timely deal acrobat lily armed kidney gesture paid evoke crucial scene forecast magazine favorite omit username alpha axis trust rhyme
timely deal acrobat lungs arena season pleasure nuclear observe duration stilt webcam tidy huge nuclear grin sled network mouse voting
timely deal beard learn branch maximum desktop welcome sheriff gray pickup depart husband describe domain buyer trash mandate dress trust
timely deal beard lips auction garden argue pacific bulge salt retailer forbid deny escape ecology harvest argue music process fumes
timely deal beard luxury both album problem anxiety rich wolf industry industry thorn threaten enemy verify type aviation aspect weapon
timely deal beard march acrobat training music hospital holiday forward hunting carbon phrase nylon dress lizard anatomy bike ordinary exact
timely deal beard method again party shrimp sprinkle terminal faint legs romp fluff easel video cards alpha surprise style duckling
timely deal ceramic learn brave rhythm family election headset genre ladle cards eclipse gray liberty public raisin warmth romp crisis
timely deal ceramic lips amount walnut bumpy headset mobile eraser necklace yoga relate promise hour depict standard fatal purple debris
timely deal ceramic luxury agree exceed grownup cards soul trouble seafood voice guitar safari royal skunk union railroad friendly eraser
timely deal ceramic march blind answer cylinder dilemma crazy ruler chubby body midst amazing cubic explain march careful deadline failure
timely deal ceramic method beyond penalty cards image testify detailed kitchen thank column merchant spark ecology garden genius gasoline pile
```

## Generating Seeds from Provided Entropy

When the `--in` option is used, seedtool takes input from stdin and uses it to construct the seed. In the examples below, the end of input to stdin is marked by `^D` on its own line.

When the input format is `hex`, the construction is the identity function (passthrough.)

```
$ seedtool --in hex
3d1d142cd016cf8a393a1b477891c5e594fb7c9479b175a0db653067d6de0b17
^D
3d1d142cd016cf8a393a1b477891c5e594fb7c9479b175a0db653067d6de0b17
```

For the other input formats, each "unit" of the input (bit, digit, card, etc.) is converted to a byte and placed in an array. The SHA256 is then taken of the resulting array, yielding a deterministic seed.

```
$ seedtool --in bits
00100010011111110100010100010000
^D
f5ed0d7a8731424f5a5596dae07c4ced7b7ea9430f2ab1d407b3c5c8fe789fb8

$ seedtool --in cards
5s4hth3s6s4s4hjdtdtdjckc7d5std6d5d4hqhkh4cks4h4sas5c6c2d6h2s2h2c
^D
1046e7b5a12a8c662599d094c939351c18e20ccde8dedd2b72d0494db8c2d4dd

$ seedtool --in dice
23431546432642433535135232426424
^D
aea2cd642bbe2f950eb77f9c508408028e20473a9fe3b11db003ca55f5ef1358

$ seedtool --in base6
14135001101503150040353141454122
^D
063aadc267da52aeeda80d77feded8a11885641a56a4312db9e106c57b875de2

$ seedtool --in base10
73127665663823895387159704567613
^D
ae6c78b68370757230102ce26d7dd40740886a4ff6dc9bd122c914695ecbdc5f

$ seedtool --in ints
71 22 95 6 23 65 27 10 67 16
^D
e98f4b80aa0eac6aac1a2086eb931f1404d8f2d193a5d6bb6cfae68161fd3da4
```

If a smaller seed is desired, the `--count` option can specify that the SHA256 be truncated to a fewer number of bytes.

```
$ seedtool --in bits --count 16
00100010011111110100010100010000
^D
f5ed0d7a8731424f5a5596dae07c4ced

$ seedtool --in cards --count 16
5s4hth3s6s4s4hjdtdtdjckc7d5std6d5d4hqhkh4cks4h4sas5c6c2d6h2s2h2c
^D
1046e7b5a12a8c662599d094c939351c
```

BIP39 and SLIP39 output formats can be combined with various other input formats. If the `--count N` option is used with the `hex` input format, it results in only the first `N` bytes of the input being used. If the `--count N` option is used with other input formats, it results in only the first `N` bytes of the SHA256 (computed as described above) to be used.

```
$ seedtool --in hex --out bip39
65d68e2855c2dd7b246de65997b016c3209b78782c8305cc30d75af681dc48bd
^D
clay notable jeans deliver mass nut claim rib double trick will awful ability lonely toss cloth myth heart box just fat disease prefer stool

$ seedtool --in dice --count 16 --out slip39 --group 2-of-3
54242562454251545633432454422543
^D
traffic branch academic acid adapt zero erode similar review platform curly knit trend usher distance escape pants machine nylon imply
traffic branch academic agency best downtown very keyboard story brave famous spelling diminish observe remove corner ticket laden justice capture
traffic branch academic always climate heat dismiss pencil deny snapshot research legend moment clothes filter memory crucial worthy argue mountain
```

BIP39 and SLIP39 can be used as input formats, in which case the original seed is output. Note that the seed returned is *not* the original entropy that was used to create the seed (like dice rolls) but the SHA256 (or part thereof) that was originally used to create the BIP39 words or SLIP39 shares.

```
$ seedtool --in bip39
clay notable jeans deliver mass nut claim rib double trick will awful ability lonely toss cloth myth heart box just fat disease prefer stool
^D
65d68e2855c2dd7b246de65997b016c3209b78782c8305cc30d75af681dc48bd

$ seedtool --in slip39
traffic branch academic acid adapt zero erode similar review platform curly knit trend usher distance escape pants machine nylon imply
traffic branch academic always climate heat dismiss pencil deny snapshot research legend moment clothes filter memory crucial worthy argue mountain
^D
ae752acc827ea8c02c6cc2f57370a50f
```

## Deterministic Randomness
Normally seedtool uses a cryptographically-strong random number generator provided by the operating system. This is also used when constructing SLIP39 shares, so the same entropy input will yield the different shares each time.

Seedtool also provides the `--deterministic S` option, which takes a string `S`, produces the SHA256 hash of that string, and then uses that to seed it's own cryptography-quality random number generator it uses for the rest of its run. This means that seeds generated by seedtool with the same `--deterministic` input will yield the same results.

In the example below, seedtool is run with a  `--deterministic test` twice, producing the same results. In the third run the string is `test2`, producing different, yet still deterministic results.

```
$ seedtool --deterministic test
3b1e91644fd5475251f55d3ba98d3956bd7c73ce478afb5ce047682a4417e292

$ seedtool --deterministic test
3b1e91644fd5475251f55d3ba98d3956bd7c73ce478afb5ce047682a4417e292

$ seedtool --deterministic test2
68b275e740cb5f89bb5444694aaa2dbc82ab6aa4d9869b3995cb6aa3c622e6d1
```

In this example, the same entropy is used twice in producing a SLIP39 share, which would normally result in two different shares being produced. But by providing `--deterministic test`, the same results are produced. In the third run, there is no `--deterministic` option, so different, truly randomized shares are produced even though the input entropy is the same.

```
$ seedtool --deterministic test --in dice --count 16 --out slip39 --group 2-of-3
5253423623323232
^D
peaceful traffic academic acid artwork else mixed twice standard fishing railroad safari herald ceramic training famous axle mandate lyrics aunt
peaceful traffic academic agency carbon sprinkle echo secret slow market idea intend counter home pajamas silver flash edge slow upgrade
peaceful traffic academic always critical jury depend beyond clock weapon dynamic practice threaten river isolate husky funding welcome have priority

$ seedtool --deterministic test --in dice --count 16 --out slip39 --group 2-of-3
5253423623323232
^D
peaceful traffic academic acid artwork else mixed twice standard fishing railroad safari herald ceramic training famous axle mandate lyrics aunt
peaceful traffic academic agency carbon sprinkle echo secret slow market idea intend counter home pajamas silver flash edge slow upgrade
peaceful traffic academic always critical jury depend beyond clock weapon dynamic practice threaten river isolate husky funding welcome have priority

$ seedtool --in dice --count 16 --out slip39 --group 2-of-3
5253423623323232
^D
distance isolate academic acid campus upgrade much luck grin material voting forward pencil union worthy demand decent armed switch equation
distance isolate academic agency alto payment tension river script prevent lair solution agree remind destroy learn earth industry oral bishop
distance isolate academic always costume fiber behavior flame pancake slice luxury flea gesture ecology herd flavor daisy voting wavy cradle
```
